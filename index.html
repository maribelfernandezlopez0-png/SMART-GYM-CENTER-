<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S.M.G CENTER - ELITE SYSTEM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --panel-bg: #111111;
            --accent-red: #ff0000;
            --text-gray: #e0e0e0;
            --pastel-green: #b2f2bb;
            --pastel-red: #ffb7b2;
            --pastel-blue: #b2e2f2;
            --pastel-orange: #ffdfba;
            --border-color: #222;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', Roboto, sans-serif; }
        body { margin: 0; background-color: var(--bg-dark); color: var(--text-gray); display: flex; height: 100vh; overflow: hidden; }

        /* SIDEBAR (ESTRUCTURA DE IMAGEN) */
        .sidebar { width: 240px; background: black; border-right: 2px solid var(--accent-red); display: flex; flex-direction: column; padding: 20px 0; }
        .logo-area { text-align: center; padding-bottom: 30px; }
        .logo-area i { font-size: 50px; color: var(--accent-red); filter: drop-shadow(0 0 10px rgba(255,0,0,0.5)); }
        .logo-area h1 { font-size: 18px; margin-top: 10px; letter-spacing: 1px; }

        .nav-menu { flex: 1; }
        .nav-item { 
            display: flex; align-items: center; padding: 15px 25px; color: #888; 
            text-decoration: none; font-size: 13px; font-weight: bold; cursor: pointer; border-left: 4px solid transparent;
        }
        .nav-item:hover, .nav-item.active { color: white; background: #111; border-left: 4px solid var(--accent-red); }
        .nav-item i { margin-right: 15px; width: 20px; text-align: center; }

        /* MAIN CONTENT */
        .main-content { flex: 1; padding: 30px; overflow-y: auto; }
        .header-title { color: var(--accent-red); font-size: 24px; font-weight: bold; margin-bottom: 30px; border-left: 5px solid var(--accent-red); padding-left: 15px; text-transform: uppercase; }

        /* CARDS & PANELS */
        .stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--panel-bg); padding: 20px; border-radius: 10px; border: 1px solid var(--border-color); text-align: center; }
        .stat-card h3 { margin: 5px 0; font-size: 24px; }
        .stat-card p { margin: 0; font-size: 11px; color: #666; text-transform: uppercase; }

        .glass-panel { background: var(--panel-bg); padding: 30px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        /* FORMS */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .field { display: flex; flex-direction: column; margin-bottom: 15px; }
        label { font-size: 12px; color: #888; margin-bottom: 8px; text-transform: uppercase; }
        input, select { 
            background: #1a1a1a; border: 1px solid #333; padding: 12px; color: white; 
            border-radius: 5px; outline: none; transition: 0.3s;
        }
        input:focus { border-color: var(--accent-red); }
        .btn-action { 
            grid-column: span 2; background: var(--accent-red); color: white; border: none; 
            padding: 15px; font-weight: bold; border-radius: 5px; cursor: pointer; margin-top: 10px; text-transform: uppercase;
        }
        .btn-action:hover { background: #cc0000; }

        /* TABLES (DISE√ëO DE IMAGEN) */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { color: #f1c40f; font-size: 12px; padding: 15px; border-bottom: 2px solid var(--accent-red); text-transform: uppercase; }
        td { padding: 15px; text-align: center; border-bottom: 1px solid #222; font-size: 14px; }
        
        .badge { padding: 5px 10px; border-radius: 4px; font-weight: bold; font-size: 11px; }
        .bg-vigente { background: var(--pastel-green); color: #1e3a20; }
        .bg-vencido { background: var(--pastel-red); color: #4a1a1a; }
        
        .btn-delete { color: var(--accent-red); background: none; border: none; cursor: pointer; font-size: 18px; }

        /* MODAL */
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; }
        .ficha { background: var(--panel-bg); width: 350px; padding: 30px; border-radius: 10px; border-top: 5px solid var(--accent-red); text-align: center; }

        /* TICKET */
        #ticket-print { display: none; width: 280px; padding: 20px; background: white; color: black; font-family: monospace; text-align: center; }
        @media print { body * { visibility: hidden; } #ticket-print, #ticket-print * { visibility: visible; } #ticket-print { position: absolute; left:0; top:0; display: block; } }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="logo-area">
        <i class="fa-solid fa-dumbbell"></i>
        <h1>S.M.G CENTER</h1>
    </div>
    <div class="nav-menu">
        <div class="nav-item active" onclick="showSection('reg-sec')"><i class="fa fa-user-plus"></i> REGISTRAR</div>
        <div class="nav-item" onclick="showSection('list-sec')"><i class="fa fa-users"></i> SOCIOS</div>
        <div class="nav-item" onclick="showSection('caja-sec')"><i class="fa fa-wallet"></i> HISTORIAL / CAJA</div>
    </div>
</div>

<div class="main-content">
    
    <div id="reg-sec" class="section">
        <div class="header-title">Registro de Membres√≠a</div>
        <div class="glass-panel" style="max-width: 700px;">
            <div class="form-grid">
                <div class="field" style="grid-column: span 2;">
                    <label>Nombre del Cliente</label>
                    <input type="text" id="in-nombre" placeholder="NOMBRE COMPLETO">
                </div>
                <div class="field">
                    <label>Plan</label>
                    <select id="in-plan" onchange="updatePrice(); calcDates();">
                        <option value="SEMANAL">SEMANAL ($150)</option>
                        <option value="MENSUAL">MENSUAL ($380)</option>
                    </select>
                </div>
                <div class="field">
                    <label>Inicia el d√≠a</label>
                    <input type="date" id="in-inicio" onchange="calcDates()">
                </div>
                <div class="field">
                    <label>Monto Recibido (Abono)</label>
                    <input type="number" id="in-pago" onkeyup="calcDeuda()" value="150">
                </div>
                <div class="field">
                    <label>M√©todo de Pago</label>
                    <select id="in-metodo">
                        <option value="EFECTIVO">EFECTIVO</option>
                        <option value="TRANSFERENCIA">TRANSFERENCIA</option>
                    </select>
                </div>
                <div class="field">
                    <label>Resta (Deuda)</label>
                    <input type="text" id="in-resta" readonly style="color:var(--pastel-red); font-weight:bold;">
                </div>
                <div class="field">
                    <label>Vence el d√≠a</label>
                    <input type="date" id="in-vence" readonly>
                </div>
                <button class="btn-action" onclick="saveData()">REGISTRAR E IMPRIMIR</button>
            </div>
        </div>
    </div>

    <div id="list-sec" class="section" style="display:none;">
        <div class="header-title">Panel de Socios</div>
        <div class="stats-row">
            <div class="stat-card"><p>Total</p><h3 id="count-total">0</h3></div>
            <div class="stat-card"><p>Vigentes</p><h3 id="count-v" style="color:var(--pastel-green)">0</h3></div>
            <div class="stat-card"><p>Deudores</p><h3 id="count-d" style="color:var(--pastel-orange)">0</h3></div>
        </div>
        <div class="glass-panel">
            <input type="text" id="search" onkeyup="renderTable()" placeholder="üîç BUSCAR SOCIO..." style="width:100%; margin-bottom:20px; padding:12px; background:#000; border:1px solid #333; color:white;">
            <table>
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Estado</th>
                        <th>Deuda</th>
                        <th>Vence</th>
                        <th>Acci√≥n</th>
                    </tr>
                </thead>
                <tbody id="table-body"></tbody>
            </table>
        </div>
    </div>

    <div id="caja-sec" class="section" style="display:none;">
        <div class="header-title">Caja e Ingresos</div>
        <div class="stats-row">
            <div class="stat-card"><p>Efectivo</p><h3 id="cj-e" style="color:var(--pastel-green)">$0</h3></div>
            <div class="stat-card"><p>Transferencias</p><h3 id="cj-t" style="color:var(--pastel-blue)">$0</h3></div>
        </div>
        <div class="glass-panel">
            <table>
                <thead>
                    <tr><th>Fecha</th><th>Socio</th><th>M√©todo</th><th>Monto</th></tr>
                </thead>
                <tbody id="caja-body"></tbody>
            </table>
        </div>
    </div>

</div>

<div id="modalFicha" class="modal" onclick="closeFicha()">
    <div class="ficha" onclick="event.stopPropagation()">
        <h2 id="f-nom"></h2>
        <p id="f-plan" style="color:var(--accent-red); font-weight:bold;"></p>
        <hr border="0" style="border-top:1px solid #333; margin:20px 0;">
        <div style="text-align:left; font-size:14px;">
            <p>Vencimiento: <b id="f-ven"></b></p>
            <p>√öltimo Pago: <span id="f-pag"></span></p>
            <p>M√©todo: <span id="f-met"></span></p>
            <p style="font-size:18px;">DEUDA: <b id="f-deuda" style="color:var(--pastel-red)"></b></p>
        </div>
        <button class="btn-action" onclick="closeFicha()">CERRAR</button>
    </div>
</div>

<div id="ticket-print">
    <h3>SMG CENTER</h3>
    <p>RECIBO DE PAGO</p>
    <hr>
    <div style="text-align:left;">
        Socio: <b id="t-nom"></b><br>
        Plan: <span id="t-plan"></span><br>
        Fecha: <span id="t-fec"></span><br>
        Pag√≥: <b id="t-pag"></b> (<span id="t-met"></span>)<br>
        Deuda: <span id="t-res"></span>
    </div>
    <hr>
    <h4>PR√ìX. VENCIMIENTO: <span id="t-ven"></span></h4>
    <p>¬°ENTRENA CON PASI√ìN!</p>
</div>

<script>
    let socios = JSON.parse(localStorage.getItem('smg_v5_socios')) || [];
    let ingresos = JSON.parse(localStorage.getItem('smg_v5_caja')) || [];

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
        document.getElementById(id).style.display = 'block';
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        event.currentTarget.classList.add('active');
        if(id==='list-sec') renderTable();
        if(id==='caja-sec') renderCaja();
    }

    function updatePrice() {
        const p = document.getElementById('in-plan').value;
        document.getElementById('in-pago').value = (p === 'SEMANAL' ? 150 : 380);
        calcDeuda();
    }

    function calcDeuda() {
        const plan = document.getElementById('in-plan').value;
        const total = (plan === 'SEMANAL' ? 150 : 380);
        const pago = parseFloat(document.getElementById('in-pago').value) || 0;
        document.getElementById('in-resta').value = "$" + (total - pago);
    }

    function calcDates() {
        const ini = document.getElementById('in-inicio').value;
        if(!ini) return;
        let d = new Date(ini + 'T00:00:00');
        const plan = document.getElementById('in-plan').value;
        d.setDate(d.getDate() + (plan === 'SEMANAL' ? 7 : 30));
        d.setDate(d.getDate() - 1);
        document.getElementById('in-vence').value = d.toISOString().split('T')[0];
    }

    function saveData() {
        const n = document.getElementById('in-nombre').value.toUpperCase();
        const p = document.getElementById('in-pago').value;
        const r = document.getElementById('in-resta').value;
        const v = document.getElementById('in-vence').value;
        const m = document.getElementById('in-metodo').value;
        const pl = document.getElementById('in-plan').value;
        const ini = document.getElementById('in-inicio').value;

        if(!n || !ini || !p) return alert("Faltan datos");

        const obj = { nombre: n, pago: p, resta: r, vence: v, metodo: m, plan: pl, inicio: ini };
        socios.push(obj);
        ingresos.unshift({ fecha: new Date().toLocaleDateString(), socio: n, monto: p, metodo: m });

        localStorage.setItem('smg_v5_socios', JSON.stringify(socios));
        localStorage.setItem('smg_v5_caja', JSON.stringify(ingresos));

        printRecibo(obj);
        showSection('list-sec');
    }

    function renderTable() {
        const body = document.getElementById('table-body');
        const filter = document.getElementById('search').value.toUpperCase();
        const hoy = new Date().toISOString().split('T')[0];
        body.innerHTML = '';
        
        let t=0, v=0, d=0;
        socios.forEach((s, i) => {
            if(s.nombre.includes(filter)) {
                const isV = s.vence >= hoy;
                const hasD = s.resta !== "$0";
                t++; if(isV) v++; if(hasD) d++;

                body.innerHTML += `<tr>
                    <td style="color:white; font-weight:bold; cursor:pointer" onclick="verFicha(${i})">${s.nombre}</td>
                    <td><span class="badge ${isV?'bg-vigente':'bg-vencido'}">${isV?'VIGENTE':'VENCIDO'}</span></td>
                    <td style="color:${hasD?'#f1c40f':'#666'}">${hasD ? 'DEBE: '+s.resta : 'PAGADO'}</td>
                    <td>${s.vence}</td>
                    <td><button class="btn-delete" onclick="borrar(${i})">üóëÔ∏è</button></td>
                </tr>`;
            }
        });
        document.getElementById('count-total').innerText = t;
        document.getElementById('count-v').innerText = v;
        document.getElementById('count-d').innerText = d;
    }

    function verFicha(i) {
        const s = socios[i];
        document.getElementById('f-nom').innerText = s.nombre;
        document.getElementById('f-plan').innerText = s.plan;
        document.getElementById('f-ven').innerText = s.vence;
        document.getElementById('f-pag').innerText = "$" + s.pago;
        document.getElementById('f-met').innerText = s.metodo;
        document.getElementById('f-deuda').innerText = s.resta;
        document.getElementById('modalFicha').style.display = 'flex';
    }

    function closeFicha() { document.getElementById('modalFicha').style.display = 'none'; }

    function renderCaja() {
        let e=0, t=0;
        document.getElementById('caja-body').innerHTML = ingresos.map(i => {
            if(i.metodo==='EFECTIVO') e += parseFloat(i.monto); else t += parseFloat(i.monto);
            return `<tr><td>${i.fecha}</td><td>${i.socio}</td><td>${i.metodo}</td><td>$${i.monto}</td></tr>`;
        }).join('');
        document.getElementById('cj-e').innerText = "$" + e;
        document.getElementById('cj-t').innerText = "$" + t;
    }

    function borrar(i) { if(confirm("¬øEliminar socio?")) { socios.splice(i,1); localStorage.setItem('smg_v5_socios', JSON.stringify(socios)); renderTable(); } }

    function printRecibo(s) {
        document.getElementById('t-nom').innerText = s.nombre;
        document.getElementById('t-plan').innerText = s.plan;
        document.getElementById('t-fec').innerText = new Date().toLocaleDateString();
        document.getElementById('t-pag').innerText = "$" + s.pago;
        document.getElementById('t-met').innerText = s.metodo;
        document.getElementById('t-res').innerText = s.resta;
        document.getElementById('t-ven').innerText = s.vence;
        window.print();
    }

    // Inicializar
    document.getElementById('in-inicio').valueAsDate = new Date();
    updatePrice();
    calcDates();
</script>
</body>
</html>
